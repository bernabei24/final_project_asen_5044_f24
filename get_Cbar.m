function [Cbar] = get_Cbar(x)
% inputs
    % x: vector of inputs in form x = [Eg Ng thetag Ea Na thetaa]^T

    Cbar = [(x(5)-x(2))/((x(4)-x(1))^2 + (x(2)-x(5))^2),     -(x(4)-x(1))/((x(4)-x(1))^2 + (x(2)-x(5))^2),    -1, -(x(2)-x(5))/((x(4)-x(1))^2 + (x(2)-x(5))^2),    (x(4)-x(1))/((x(4)-x(1))^2 + (x(2)-x(5))^2),     0;
            (x(4)+x(1))/sqrt((x(4)+x(1))^2 + (x(2)+x(5))^2), (x(2)+x(5))/sqrt((x(4)+x(1))^2 + (x(2)+x(5))^2), 0,  (x(4)+x(1))/sqrt((x(4)+x(1))^2 + (x(2)+x(5))^2), (x(2)+x(5))/sqrt((x(4)+x(1))^2 + (x(2)+x(5))^2), 0;
            -(x(2)-x(5))/((x(1)-x(4))^2 + (x(2)-x(5))^2),    (x(1)-x(4))/((x(1)-x(4))^2 + (x(2)-x(5))^2),     0,  (x(2)-x(5))/((x(1)-x(4))^2 + (x(2)-x(5))^2),     -(x(1)-x(4))/((x(1)-x(4))^2 + (x(2)-x(5))^2),    -1;
            0, 0, 0, 1, 0, 0;
            0, 0, 0, 0, 1, 0];
end

